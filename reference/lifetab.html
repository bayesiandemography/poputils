<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate Life Tables or Life Expectancies — lifetab • poputils</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate Life Tables or Life Expectancies — lifetab"><meta name="description" content="Calculate life table quantities. Function
lifetab() returns an entire life table.
Function lifeexp() returns life expectancy at birth.
The inputs can be mortality rates (mx) or
probabilities of dying (qx), though not both."><meta property="og:description" content="Calculate life table quantities. Function
lifetab() returns an entire life table.
Function lifeexp() returns life expectancy at birth.
The inputs can be mortality rates (mx) or
probabilities of dying (qx), though not both."><meta property="og:image" content="https://bayesiandemography.github.io/poputils/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">poputils</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/poputils.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bayesiandemography/poputils/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate Life Tables or Life Expectancies</h1>
      <small class="dont-index">Source: <a href="https://github.com/bayesiandemography/poputils/blob/main/R/lifetab.R" class="external-link"><code>R/lifetab.R</code></a></small>
      <div class="d-none name"><code>lifetab.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculate life table quantities. Function
<code>lifetab()</code> returns an entire life table.
Function <code>lifeexp()</code> returns life expectancy at birth.
The inputs can be mortality rates (<code>mx</code>) or
probabilities of dying (<code>qx</code>), though not both.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">lifetab</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  mx <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  qx <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  age <span class="op">=</span> <span class="va">age</span>,</span>
<span>  sex <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ax <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  infant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"constant"</span>, <span class="st">"linear"</span>, <span class="st">"CD"</span>, <span class="st">"AK"</span><span class="op">)</span>,</span>
<span>  child <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"constant"</span>, <span class="st">"linear"</span>, <span class="st">"CD"</span><span class="op">)</span>,</span>
<span>  closed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"constant"</span>, <span class="st">"linear"</span><span class="op">)</span>,</span>
<span>  open <span class="op">=</span> <span class="st">"constant"</span>,</span>
<span>  radix <span class="op">=</span> <span class="fl">1e+05</span>,</span>
<span>  suffix <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">lifeexp</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  mx <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  qx <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  at <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  age <span class="op">=</span> <span class="va">age</span>,</span>
<span>  sex <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ax <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  infant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"constant"</span>, <span class="st">"linear"</span>, <span class="st">"CD"</span>, <span class="st">"AK"</span><span class="op">)</span>,</span>
<span>  child <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"constant"</span>, <span class="st">"linear"</span>, <span class="st">"CD"</span><span class="op">)</span>,</span>
<span>  closed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"constant"</span>, <span class="st">"linear"</span><span class="op">)</span>,</span>
<span>  open <span class="op">=</span> <span class="st">"constant"</span>,</span>
<span>  suffix <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Data frame with mortality data.</p></dd>


<dt id="arg-mx">mx<a class="anchor" aria-label="anchor" href="#arg-mx"></a></dt>
<dd><p>&lt;<code><a href="https://tidyselect.r-lib.org/reference/language.html" class="external-link">tidyselect</a></code>&gt;
Mortality rates, expressed as deaths per
person-year lived. Possibly an <a href="https://bayesiandemography.github.io/rvec/reference/rvec.html" class="external-link">rvec</a>.</p></dd>


<dt id="arg-qx">qx<a class="anchor" aria-label="anchor" href="#arg-qx"></a></dt>
<dd><p>&lt;<code><a href="https://tidyselect.r-lib.org/reference/language.html" class="external-link">tidyselect</a></code>&gt;
Probability of dying within age interval.
An alternative to <code>mx</code>. Possibly an <a href="https://bayesiandemography.github.io/rvec/reference/rvec.html" class="external-link">rvec</a>.</p></dd>


<dt id="arg-age">age<a class="anchor" aria-label="anchor" href="#arg-age"></a></dt>
<dd><p>&lt;<code><a href="https://tidyselect.r-lib.org/reference/language.html" class="external-link">tidyselect</a></code>&gt;
Age group labels. The labels must be
interpretable by functions
such as <code><a href="reformat_age.html">reformat_age()</a></code> and <code><a href="age_group_type.html">age_group_type()</a></code>.
The first age group must start at age 0, and the
last age group must be "open", with no upper
limit.</p></dd>


<dt id="arg-sex">sex<a class="anchor" aria-label="anchor" href="#arg-sex"></a></dt>
<dd><p>&lt;<code><a href="https://tidyselect.r-lib.org/reference/language.html" class="external-link">tidyselect</a></code>&gt;
Biological sex, with labels that can be
interpreted by <code><a href="reformat_sex.html">reformat_sex()</a></code>. Needed only when
<code>infant</code> is <code>"CD"</code> or <code>"AK"</code>, or <code>child</code> is
<code>"CD"</code>.</p></dd>


<dt id="arg-ax">ax<a class="anchor" aria-label="anchor" href="#arg-ax"></a></dt>
<dd><p>&lt;<code><a href="https://tidyselect.r-lib.org/reference/language.html" class="external-link">tidyselect</a></code>&gt;
Average age at death within age group.
Optional. See Details.</p></dd>


<dt id="arg-by">by<a class="anchor" aria-label="anchor" href="#arg-by"></a></dt>
<dd><p>&lt;<code><a href="https://tidyselect.r-lib.org/reference/language.html" class="external-link">tidyselect</a></code>&gt;
Separate life tables, or life expectancies,
calculated for each combination the <code>by</code> variables.
If a <code>sex</code> variable was specified, then that
variable is automatically included among the <code>by</code>
variables. If <code>data</code> is a
<a href="https://dplyr.tidyverse.org/reference/group_data.html" class="external-link">grouped</a>
data frame, then the grouping variables
take precedence over <code>by</code>.</p></dd>


<dt id="arg-infant">infant<a class="anchor" aria-label="anchor" href="#arg-infant"></a></dt>
<dd><p>Method used to calculate
life table values in age group <code>"0"</code>.
Ignored if <code>age</code> does not include age group <code>"0"</code>.
Default is <code>"constant"</code>.</p></dd>


<dt id="arg-child">child<a class="anchor" aria-label="anchor" href="#arg-child"></a></dt>
<dd><p>Method used to calculate
life table values in age group <code>"1-4"</code>.
Ignored if <code>age</code> does not include age group <code>"0"</code>.
Default is <code>"constant"</code>.</p></dd>


<dt id="arg-closed">closed<a class="anchor" aria-label="anchor" href="#arg-closed"></a></dt>
<dd><p>Method used to calculate
life table values in closed age intervals
other than <code>"0"</code> and <code>"1-4"</code> (ie intervals
such as "10-14" or "12"). Default is <code>"constant"</code>.</p></dd>


<dt id="arg-open">open<a class="anchor" aria-label="anchor" href="#arg-open"></a></dt>
<dd><p>Method used to calculate
life table values in the final, open age group
(eg <code>"80+"</code> or <code>"110+"</code>).
Currently the only option is `"constant".</p></dd>


<dt id="arg-radix">radix<a class="anchor" aria-label="anchor" href="#arg-radix"></a></dt>
<dd><p>Initial population for the
<code>lx</code> column. Default is <code>100000</code>.</p></dd>


<dt id="arg-suffix">suffix<a class="anchor" aria-label="anchor" href="#arg-suffix"></a></dt>
<dd><p>Optional suffix added to new
columns in result.</p></dd>


<dt id="arg-at">at<a class="anchor" aria-label="anchor" href="#arg-at"></a></dt>
<dd><p>Age at which life expectancy is calculated
(<code>lifeexp() only). Default is </code>0`.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="definitions-of-life-table-quantities">Definitions of life table quantities<a class="anchor" aria-label="anchor" href="#definitions-of-life-table-quantities"></a></h2>


<ul><li><p><code>mx</code> Deaths per person-year lived.</p></li>
<li><p><code>qx</code> Probability of surviving from the start
of age group 'x' to the end.</p></li>
<li><p><code>lx</code> Number of people alive at
the start of age group <code>x</code>.</p></li>
<li><p><code>dx</code> Number of deaths in age group <code>x</code></p></li>
<li><p><code>Lx</code> Expected number of person years lived in
age group <code>x</code>.</p></li>
<li><p><code>ex</code> Life expectancy, calculated at the start
of age group <code>x</code>.</p></li>
</ul><p>Mortality rates <code>mx</code> are sometimes expressed
as deaths per 1000 person-years lived, or per 100,000
person-years lived. <code>lifetab()</code> and <code>lifeexp()</code>
assumed that they are expressed as deaths per
person-year lived.</p>
    </div>
    <div class="section level2">
    <h2 id="calculation-methods">Calculation methods<a class="anchor" aria-label="anchor" href="#calculation-methods"></a></h2>



<p><code>lifetab()</code> and <code>lifeexp()</code> implement several
methods for calculating life table quantities
from mortality rates. Each method makes
different assumptions about
the way that mortality rates vary within
age intervals:</p><ul><li><p><code>"constant"</code> Mortality rates are constant
within each interval.</p></li>
<li><p><code>"linear"</code>. Life table quantity <code>lx</code>
is a straight line within each interval.
Equivalently, deaths are distributed uniformly
within each interval.</p></li>
<li><p><code>"CD"</code>. Used only with age groups "0"
and "1-4". Mortality rates decline
over the  age interval,
with the slope depending on the absolute
level of infant mortality. The formulas were
developed by Coale and Demeny (1983),
and used in Preston et al (2001).</p></li>
<li><p><code>"AK"</code>. Used only with age group "0".
Mortality rates decline over the age interval,
with the slope depending on the absolute
level of infant mortality. The formulas
were formulas developed by Andreev and Kingkade (2015),
and are used in the Human Mortality Database
<a href="https://www.mortality.org/File/GetDocument/Public/Docs/MethodsProtocolV6.pdf" class="external-link">methods protocol</a>.</p></li>
</ul><p>For a detailed description of the methods,
see the vignette for <strong>poputils</strong>.</p>
    </div>
    <div class="section level2">
    <h2 id="ax">ax<a class="anchor" aria-label="anchor" href="#ax"></a></h2>



<p><code>ax</code> is the average number of years
lived in an age interval by people who
die in that interval. Demographers sometimes
refer to it as the 'separation factor'. If a non-<code>NA</code>
value of <code>ax</code> is supplied for an age group,
then the results for that age group are based
on the formula</p>
<p>$$m_x = d_x / (n_x l_x + a_x d_x)$$,</p>
<p>(where <code>n_x</code> is the width of the age interval),
over-riding any methods specified via the <code>infant</code>, <code>child</code>,
<code>closed</code> and <code>open</code> arguments.</p>
    </div>
    <div class="section level2">
    <h2 id="open-age-group-when-inputs-are-qx">Open age group when inputs are qx<a class="anchor" aria-label="anchor" href="#open-age-group-when-inputs-are-qx"></a></h2>



<p>The probability of dying, <code>qx</code>, is always 1 in the
final (open) age group. <code>qx</code> therefore provides
no direct information on mortality conditions
within the final age group. <code>lifetab()</code> and
<code>lifeexp()</code> use conditions in the second-to-final
age group as a proxy for conditions in the final
age group. When <code>open</code> is <code>"constant"</code> (which
is currently the only option), and no value
for <code>ax</code> in the final age group is provided,
<code>lifetab()</code> and <code>lifeexp()</code> assume
that \(m_A = m_{A-1}\), and set
\(L_{A} = l_A / m_A\).</p>
<p>In practice, mortality is likely to be higher
in the final age group than in the second-to-final
age group, so the default procedure is likely to
lead to inaccuracies. When the size of the final
age group is very small, these inaccuracies will
be inconsequential. But in other cases, it may
be necessary to supply an explicit value for
<code>ax</code> for the final age group, or to use <code>mx</code>
rather than <code>qx</code> as inputs.</p>
    </div>
    <div class="section level2">
    <h2 id="using-rvecs-to-represent-uncertainty">Using rvecs to represent uncertainty<a class="anchor" aria-label="anchor" href="#using-rvecs-to-represent-uncertainty"></a></h2>



<p>An <a href="https://bayesiandemography.github.io/rvec/reference/rvec.html" class="external-link">rvec</a> is a 'random vector',
holding multiple draws from a distribution.
Using an rvec for the <code>mx</code> argument to
<code>lifetab()</code> or <code>lifeexp()</code> is a way of representing
uncertainty. This uncertainty is propagated
through to the life table values, which will
also be rvecs.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ul><li><p>Preston SH, Heuveline P, and Guillot M. 2001.
<em>Demography: Measuring and Modeling Population Processes</em>
Oxford: Blackwell.</p></li>
<li><p>Coale AJ, Demeny P,  and Vaughn B. 1983.
<em>Regional model life tables and stable populations</em>
New York: Academic Press.</p></li>
<li><p>Andreev, E.M. and Kingkade, W.W., 2015.
Average age at death in infancy and infant mortality level:
Reconsidering the Coale-Demeny formulas at current
levels of low mortality. <em>Demographic Research</em>,
33, pp.363-390.</p></li>
<li><p>Human Mortality Database <a href="https://www.mortality.org/File/GetDocument/Public/Docs/MethodsProtocolV6.pdf" class="external-link">Methods Protocol</a>.</p></li>
<li><p><a href="https://demographicestimation.iussp.org" class="external-link">Tools for Demographic Estimation</a>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p><code><a href="ex_to_lifetab_brass.html">ex_to_lifetab_brass()</a></code> Calculate life table from minimal inputs</p></li>
<li><p><code><a href="q0_to_m0.html">q0_to_m0()</a></code> Convert between infant mortality measures</p></li>
</ul></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## life table for females based on 'level 1'</span></span></span>
<span class="r-in"><span><span class="co">## mortality rates "West" model life table</span></span></span>
<span class="r-in"><span><span class="va">west_lifetab</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sex</span> <span class="op">==</span> <span class="st">"Female"</span>,</span></span>
<span class="r-in"><span>           <span class="va">level</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu">lifetab</span><span class="op">(</span>mx <span class="op">=</span> <span class="va">mx</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> New names:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> `qx` -&gt; `qx...5`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> `lx` -&gt; `lx...6`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> `dx` -&gt; `dx...7`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> `Lx` -&gt; `Lx...8`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> `ex` -&gt; `ex...9`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> `qx` -&gt; `qx...10`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> `lx` -&gt; `lx...11`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> `dx` -&gt; `dx...12`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> `Lx` -&gt; `Lx...13`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> `ex` -&gt; `ex...14`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 21 × 14</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    level sex    age      ax qx...5 lx...6 dx...7 Lx...8 ex...9 qx...10 lx...11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>     1 Female 0      0.35 0.366   1     0.366   0.762   20.0  0.381  <span style="text-decoration: underline;">100</span>000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>     1 Female 1-4    1.36 0.262   0.634 0.166   2.10    30.3  0.271   <span style="text-decoration: underline;">61</span>910.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>     1 Female 5-9    2.25 0.073<span style="text-decoration: underline;">2</span>  0.468 0.034<span style="text-decoration: underline;">3</span>  2.25    36.6  0.073<span style="text-decoration: underline;">4</span>  <span style="text-decoration: underline;">45</span>117.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>     1 Female 10-14  2.6  0.057<span style="text-decoration: underline;">2</span>  0.434 0.024<span style="text-decoration: underline;">8</span>  2.11    34.3  0.057<span style="text-decoration: underline;">1</span>  <span style="text-decoration: underline;">41</span>805.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>     1 Female 15-19  2.6  0.074<span style="text-decoration: underline;">0</span>  0.409 0.030<span style="text-decoration: underline;">3</span>  1.97    31.2  0.073<span style="text-decoration: underline;">9</span>  <span style="text-decoration: underline;">39</span>416.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>     1 Female 20-24  2.6  0.091<span style="text-decoration: underline;">9</span>  0.379 0.034<span style="text-decoration: underline;">8</span>  1.81    28.5  0.091<span style="text-decoration: underline;">7</span>  <span style="text-decoration: underline;">36</span>505.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>     1 Female 25-29  2.6  0.103   0.344 0.035<span style="text-decoration: underline;">3</span>  1.64    26.1  0.102   <span style="text-decoration: underline;">33</span>159.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>     1 Female 30-34  2.6  0.116   0.309 0.035<span style="text-decoration: underline;">7</span>  1.46    23.8  0.115   <span style="text-decoration: underline;">29</span>766.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>     1 Female 35-39  2.6  0.126   0.273 0.034<span style="text-decoration: underline;">4</span>  1.28    21.6  0.125   <span style="text-decoration: underline;">26</span>337.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>     1 Female 40-44  2.6  0.133   0.239 0.031<span style="text-decoration: underline;">8</span>  1.12    19.3  0.133   <span style="text-decoration: underline;">23</span>034.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 11 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 3 more variables: dx...12 &lt;dbl&gt;, Lx...13 &lt;dbl&gt;, ex...14 &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## change method for infant and children from</span></span></span>
<span class="r-in"><span><span class="co">## default ("constant") to "CD"</span></span></span>
<span class="r-in"><span><span class="va">west_lifetab</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sex</span> <span class="op">==</span> <span class="st">"Female"</span>,</span></span>
<span class="r-in"><span>           <span class="va">level</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu">lifetab</span><span class="op">(</span>mx <span class="op">=</span> <span class="va">mx</span>,</span></span>
<span class="r-in"><span>            sex <span class="op">=</span> <span class="va">sex</span>,</span></span>
<span class="r-in"><span>            infant <span class="op">=</span> <span class="st">"CD"</span>,</span></span>
<span class="r-in"><span>            child <span class="op">=</span> <span class="st">"CD"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> New names:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> `qx` -&gt; `qx...5`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> `lx` -&gt; `lx...6`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> `dx` -&gt; `dx...7`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> `Lx` -&gt; `Lx...8`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> `ex` -&gt; `ex...9`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> `qx` -&gt; `qx...10`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> `lx` -&gt; `lx...11`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> `dx` -&gt; `dx...12`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> `Lx` -&gt; `Lx...13`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> `ex` -&gt; `ex...14`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 21 × 14</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    level sex    age      ax qx...5 lx...6 dx...7 Lx...8 ex...9 qx...10 lx...11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>     1 Female 0      0.35 0.366   1     0.366   0.762   20.0  0.366  <span style="text-decoration: underline;">100</span>000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>     1 Female 1-4    1.36 0.262   0.634 0.166   2.10    30.3  0.262   <span style="text-decoration: underline;">63</span>445.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>     1 Female 5-9    2.25 0.073<span style="text-decoration: underline;">2</span>  0.468 0.034<span style="text-decoration: underline;">3</span>  2.25    36.6  0.073<span style="text-decoration: underline;">4</span>  <span style="text-decoration: underline;">46</span>836.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>     1 Female 10-14  2.6  0.057<span style="text-decoration: underline;">2</span>  0.434 0.024<span style="text-decoration: underline;">8</span>  2.11    34.3  0.057<span style="text-decoration: underline;">1</span>  <span style="text-decoration: underline;">43</span>398.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>     1 Female 15-19  2.6  0.074<span style="text-decoration: underline;">0</span>  0.409 0.030<span style="text-decoration: underline;">3</span>  1.97    31.2  0.073<span style="text-decoration: underline;">9</span>  <span style="text-decoration: underline;">40</span>918.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>     1 Female 20-24  2.6  0.091<span style="text-decoration: underline;">9</span>  0.379 0.034<span style="text-decoration: underline;">8</span>  1.81    28.5  0.091<span style="text-decoration: underline;">7</span>  <span style="text-decoration: underline;">37</span>896.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>     1 Female 25-29  2.6  0.103   0.344 0.035<span style="text-decoration: underline;">3</span>  1.64    26.1  0.102   <span style="text-decoration: underline;">34</span>422.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>     1 Female 30-34  2.6  0.116   0.309 0.035<span style="text-decoration: underline;">7</span>  1.46    23.8  0.115   <span style="text-decoration: underline;">30</span>900.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>     1 Female 35-39  2.6  0.126   0.273 0.034<span style="text-decoration: underline;">4</span>  1.28    21.6  0.125   <span style="text-decoration: underline;">27</span>340.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>     1 Female 40-44  2.6  0.133   0.239 0.031<span style="text-decoration: underline;">8</span>  1.12    19.3  0.133   <span style="text-decoration: underline;">23</span>912.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 11 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 3 more variables: dx...12 &lt;dbl&gt;, Lx...13 &lt;dbl&gt;, ex...14 &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## calculate life expectancies</span></span></span>
<span class="r-in"><span><span class="co">## for all levels, using the 'by'</span></span></span>
<span class="r-in"><span><span class="co">## argument to distinguish levels</span></span></span>
<span class="r-in"><span><span class="va">west_lifetab</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu">lifeexp</span><span class="op">(</span>mx <span class="op">=</span> <span class="va">mx</span>,</span></span>
<span class="r-in"><span>            sex <span class="op">=</span> <span class="va">sex</span>,</span></span>
<span class="r-in"><span>            infant <span class="op">=</span> <span class="st">"CD"</span>,</span></span>
<span class="r-in"><span>            child <span class="op">=</span> <span class="st">"CD"</span>,</span></span>
<span class="r-in"><span>            by <span class="op">=</span> <span class="va">level</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 50 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    level sex       ex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>     1 Female  20.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>     1 Male    18.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>     2 Female  22.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>     2 Male    20.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>     3 Female  25.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>     3 Male    22.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>     4 Female  27.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>     4 Male    25.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>     5 Female  30.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>     5 Male    27.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 40 more rows</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## obtain the same result using</span></span></span>
<span class="r-in"><span><span class="co">## 'group_by'</span></span></span>
<span class="r-in"><span><span class="va">west_lifetab</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">level</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">lifeexp</span><span class="op">(</span>mx <span class="op">=</span> <span class="va">mx</span>,</span></span>
<span class="r-in"><span>          sex <span class="op">=</span> <span class="va">sex</span>,</span></span>
<span class="r-in"><span>          infant <span class="op">=</span> <span class="st">"CD"</span>,</span></span>
<span class="r-in"><span>          child <span class="op">=</span> <span class="st">"CD"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 50 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    level sex       ex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>     1 Female  20.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>     1 Male    18.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>     2 Female  22.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>     2 Male    20.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>     3 Female  25.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>     3 Male    22.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>     4 Female  27.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>     4 Male    25.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>     5 Female  30.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>     5 Male    27.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 40 more rows</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## calculations based on 'qx'</span></span></span>
<span class="r-in"><span><span class="va">west_lifetab</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">lifeexp</span><span class="op">(</span>qx <span class="op">=</span> <span class="va">qx</span>,</span></span>
<span class="r-in"><span>          sex <span class="op">=</span> <span class="va">sex</span>,</span></span>
<span class="r-in"><span>          by <span class="op">=</span> <span class="va">level</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 50 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    level sex       ex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>     1 Female  20.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>     1 Male    18.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>     2 Female  22.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>     2 Male    20.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>     3 Female  25.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>     3 Male    22.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>     4 Female  27.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>     4 Male    25.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>     5 Female  30.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>     5 Male    27.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 40 more rows</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## life expectancy at age 60</span></span></span>
<span class="r-in"><span><span class="va">west_lifetab</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">level</span> <span class="op">==</span> <span class="fl">10</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">lifeexp</span><span class="op">(</span>mx <span class="op">=</span> <span class="va">mx</span>,</span></span>
<span class="r-in"><span>          at <span class="op">=</span> <span class="fl">60</span>,</span></span>
<span class="r-in"><span>          sex <span class="op">=</span> <span class="va">sex</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2 × 2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   sex       ex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> Female  13.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> Male    12.3</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by John Bryant.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

